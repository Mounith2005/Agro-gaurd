<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>User Feedback</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #0f2027, #c9d2d4, #245469);
      color: #e0e0e0;
      font-family: 'Segoe UI', sans-serif;
      min-height: 100vh;
      padding-top: 50px;
    }
    .card {
      background: rgba(255,255,255,0.07);
      backdrop-filter: blur(15px);
      border-radius: 15px;
      padding: 30px;
      max-width: 600px;
      margin: auto;
      box-shadow: 0 8px 25px rgba(0,0,0,0.5);
    }
    .btn-custom {
      background: linear-gradient(45deg,#4cafef,#00c6ff);
      border: none;
      color: white;
      border-radius: 30px;
      padding: 10px 25px;
      width: 100%;
      font-size: 1.1rem;
      transition: transform 0.2s ease-in-out;
    }
    .btn-custom:hover {
      transform: scale(1.05);
      box-shadow: 0 0 20px rgba(0,198,255,0.6);
    }
    textarea {
      background: rgba(255,255,255,0.1);
      border: none;
      color: #fff;
      resize: none;
    }
    textarea:focus {
      background: rgba(255,255,255,0.15);
      border: 1px solid #4cafef;
      outline: none;
    }
  </style>
</head>
<body>
  <div class="card p-4">
    <h3 class="text-center mb-4">Share Your Feedback</h3>

    <form id="feedbackForm" action="/submit_feedback" method="POST" enctype="multipart/form-data">
      <!-- Upload Image -->
      <div class="mb-3">
        <label for="file" class="form-label">Upload Leaf Image</label>
        <input type="file" class="form-control" name="file" id="file">
      </div>

      <!-- Detected Disease Dropdown -->
      <div class="mb-3">
        <label for="label" class="form-label">Detected Disease</label>
        <select class="form-select" name="label" id="detected_label" required>
          <option value="">-- Select Detected Disease --</option>
          <option value="Tomato__Bacterial_spot">Tomato__Bacterial_spot</option>
          <option value="Tomato__Early_blight">Tomato__Early_blight</option>
          <option value="Tomato__Late_blight">Tomato__Late_blight</option>
          <option value="Tomato__Leaf_Mold">Tomato__Leaf_Mold</option>
          <option value="Tomato__Septoria_leaf_spot">Tomato__Septoria_leaf_spot</option>
          <option value="Tomato__Spider_mites_Two_spotted_spider_mite">Tomato__Spider_mites_Two_spotted_spider_mite</option>
          <option value="Tomato__Target_Spot">Tomato__Target_Spot</option>
          <option value="Tomato__Tomato_YellowLeaf__Curl_Virus">Tomato__Tomato_YellowLeaf__Curl_Virus</option>
          <option value="Tomato_healthy">Tomato_healthy</option>
        </select>
      </div>

      <!-- Feedback Text -->
      <div class="mb-3">
        <label for="feedback" class="form-label">Feedback</label>
        <textarea class="form-control" name="feedback" rows="5" placeholder="Write your feedback here..." required></textarea>
      </div>

      <button type="submit" class="btn btn-custom">Submit Feedback</button>
    </form>

    <a href="/" class="btn btn-custom mt-3">â¬… Back to Home</a>
  </div>

  <script>
    const fileInput = document.getElementById('file');
    const labelSelect = document.getElementById('detected_label');

    fileInput.addEventListener('change', function() {
      const file = this.files[0];
      if (!file) return;

      const formData = new FormData();
      formData.append('file', file);

      fetch('/predict', {
        method: 'POST',
        body: formData
      })
      .then(res => res.json())
      .then(data => {
        const option = Array.from(labelSelect.options).find(opt => opt.value === data.label);
        if (option) option.selected = true;
      })
      .catch(err => console.error(err));
    });
  </script>
</body>
</html>
